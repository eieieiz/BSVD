# general settings
name: bsvd_c32
model_type: DenoisingModel

num_gpu: 1  # set num_gpu: 0 for cpu mode
gpu_ids: '0'
manual_seed: 10

# dataset and data loader settings
datasets:
  val_d1:
    name: IRdataset
    type: ValFolderDataset
    valsetdir: /mnt/adisk/thales/BSVD/tmp_dataset/IRdataset
    num_validation_frames: 50
    valnoisestd: 0
    read_std: true
    noisy_input: true
    # scene_name: tractor
  val_d2:
    name: drone30
    type: ValFolderDataset
    valsetdir: /mnt/adisk/thales/BSVD/tmp_dataset/drone30
    num_validation_frames: 50
    valnoisestd: 30
    read_std: false
    noisy_input: true

  val_d3:
    name: Set8_20
    type: ValFolderDataset
    valsetdir: ./datasets/Set8
    num_validation_frames: 50
    valnoisestd: 20
    read_std: false
    noisy_input: false
    scene_name: tractor
  # val_d2:
  #   name: drone_20
  #   type: ValFolderDataset
  #   valsetdir: /mnt/ddisk/zzheng/remote/weird/mnt/adisk/pariasm/drone-rgb-dataset/noisy-short/AWGN20
  #   num_validation_frames: 50
  #   valnoisestd: 20
  #   # scene_name: carousel
  # val_d3:
  #   name: drone_30
  #   type: ValFolderDataset
  #   valsetdir: /mnt/ddisk/zzheng/remote/weird/mnt/adisk/pariasm/drone-rgb-dataset/noisy-short/AWGN30
  #   num_validation_frames: 50
  #   valnoisestd: 30
  #   # scene_name: carousel
  # val_d4:
  #   name: drone_40
  #   type: ValFolderDataset
  #   valsetdir: /mnt/ddisk/zzheng/remote/weird/mnt/adisk/pariasm/drone-rgb-dataset/noisy-short/AWGN40
  #   num_validation_frames: 50
  #   valnoisestd: 40
  #   # scene_name: carousel
  # val_d5:
  #   name: drone_50
  #   type: ValFolderDataset
  #   valsetdir: /mnt/ddisk/zzheng/remote/weird/mnt/adisk/pariasm/drone-rgb-dataset/noisy-short/AWGN50
  #   num_validation_frames: 50
  #   valnoisestd: 50
  #   # scene_name: carousel

  

# network structures
network_g:
  type: BSVD
  chns: [32, 64, 128]
  mid_ch: 32
  shift_input: False
  norm: 'none'
  interm_ch: 30
  act: 'relu6'
  pretrain_ckpt: './experiments/pretrained_ckpt/bsvd_32.pth'


# path
path:
  pretrain_network_g: ~
  # param_key_g: None
  strict_load_g: true
  resume_state: ~
  save_path: /mnt/adisk/thales/BSVD/tmp



# validation settings
val:
  # val_freq: !!float 5e3
  val_freq: !!float 1e0
  save_img: true
  temp_psz: -1
  future_buffer_len: 0
  patch_mod: 64
  fp16: True

  metrics:
  #   psnr: # metric name, can be arbitrary
  #     type: calculate_psnr
  #     crop_border: 2
  #     test_y_channel: false
  #   psnr_float: # metric name, can be arbitrary
  #     type: calculate_psnr_float
  #     crop_border: 2
  #     test_y_channel: false
  #   ssim: # metric name, can be arbitrary
  #     type: calculate_ssim
  #     crop_border: 2
  #     test_y_channel: false

# logging settings
logger:
  print_freq: 100
  save_checkpoint_freq: !!float 5e3
  use_tb_logger: true
  wandb:
    project: ~
    resume_id: ~

# dist training settings
# dist_params:
#   backend: nccl
#   port: 29500
# OMP_NUM_THREADS=16 CUDA_VISIBLE_DEVICES=0 python ./run_test.py -opt ./options/test/bsvd_c64.yml
# CUDA_VISIBLE_DEVICES=7 python -m torch.distributed.launch --nproc_per_node=2 --master_port=4321 ./run_sever3.py -opt ./options/train/train_RescalingNet_V3_wo_degrad_chn_attn_gradient_clip.yml --debug --launcher pytorch